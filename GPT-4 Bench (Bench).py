import pandas as pd
import time
import openai
import json
from typing import Dict, List, Tuple
import subprocess
import sys
import pkg_resources

class GPT4oBenchmark:
    def __init__(self):
        """–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º OpenRouter API"""
        self.client = openai.OpenAI(
            base_url="https://openrouter.ai/api/v1",
            api_key=""
        )
        
        self.metrics = {
            "–†–æ–±–æ—Ç–∞ –∑ –¥–∞–Ω–∏–º–∏": {
                "–ó–∞–≥–∞–ª—å–Ω—ñ –∑–Ω–∞–Ω–Ω—è": ["MMLU", "MMLU-Redux", "MMLU-Pro", "DROP", "IF-Eval"],
                "–°–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ç–µ—Å—Ç–∏": ["GPQA-Diamond", "FRAMES", "LongBench"]
            },
            "–ü—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è": {
                "–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–æ–¥—É": ["HumanEval-Mul", "LiveCodeBench", "LiveCodeBench-COT"],
                "–Ü–Ω–∂–µ–Ω–µ—Ä—ñ—è": ["Codeforces", "SWE-Verified", "Aider-Edit", "Aider-Polyglot"]
            },
            "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞": {
                "–ë–∞–∑–æ–≤–∞": ["MATH-500"],
                "–ü—Ä–æ—Å—É–Ω—É—Ç–∞": ["AIME", "CNMO"]
            },
            "–ö–∏—Ç–∞–π—Å—å–∫–∞": ["CLUEWSC", "C-Eval", "C-SimpleQA"]
        }
        
        self.test_data = self._load_test_data()
        self.results = {}

    def _load_test_data(self) -> Dict[str, List[Tuple]]:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö"""
        test_data = {
            "MMLU": [
                ("–Ø–∫–∞ —Å—Ç–æ–ª–∏—Ü—è –§—Ä–∞–Ω—Ü—ñ—ó?", ["–õ–æ–Ω–¥–æ–Ω", "–ü–∞—Ä–∏–∂", "–ë–µ—Ä–ª—ñ–Ω", "–ú–∞–¥—Ä–∏–¥"], 1),
                ("–Ø–∫–∞ –ø–ª–∞–Ω–µ—Ç–∞ –≤—ñ–¥–æ–º–∞ —è–∫ –ß–µ—Ä–≤–æ–Ω–∞ –ü–ª–∞–Ω–µ—Ç–∞?", ["–í–µ–Ω–µ—Ä–∞", "–ú–∞—Ä—Å", "–Æ–ø—ñ—Ç–µ—Ä", "–°–∞—Ç—É—Ä–Ω"], 1),
                ("–•—Ç–æ –Ω–∞–ø–∏—Å–∞–≤ '–í–±–∏—Ç–∏ –ø–µ—Ä–µ—Å–º—ñ—à–Ω–∏–∫–∞'?", ["–î–∂.–ö. –†–æ—É–ª—ñ–Ω–≥", "–ì–∞—Ä–ø–µ—Ä –õ—ñ", "–°—Ç—ñ–≤–µ–Ω –ö—ñ–Ω–≥", "–ï—Ä–Ω–µ—Å—Ç –•–µ–º—ñ–Ω–≥—É–µ–π"], 1),
                ("–Ø–∫–∏–π —Ö—ñ–º—ñ—á–Ω–∏–π —Å–∏–º–≤–æ–ª –∑–æ–ª–æ—Ç–∞?", ["Au", "Ag", "Fe", "Hg"], 0),
                ("–£ —è–∫–æ–º—É —Ä–æ—Ü—ñ –∑–∞–∫—ñ–Ω—á–∏–ª–∞—Å—è –î—Ä—É–≥–∞ —Å–≤—ñ—Ç–æ–≤–∞ –≤—ñ–π–Ω–∞?", ["1943", "1945", "1950", "1939"], 1)
            ],
            "MMLU-Redux": [
                ("–Ø–∫–∏–π –∞—Ç–æ–º–Ω–∏–π –Ω–æ–º–µ—Ä –∫–∏—Å–Ω—é?", ["6", "7", "8", "9"], 2),
                ("–•—Ç–æ –≤—ñ–¥–∫—Ä–∏–≤ –ø–µ–Ω—ñ—Ü–∏–ª—ñ–Ω?", ["–ú–∞—Ä—ñ—è –ö—é—Ä—ñ", "–û–ª–µ–∫—Å–∞–Ω–¥—Ä –§–ª–µ–º—ñ–Ω–≥", "–õ—É—ó –ü–∞—Å—Ç–µ—Ä", "–†–æ–±–µ—Ä—Ç –ö–æ—Ö"], 1),
                ("–Ø–∫–∞ —Å—Ç–æ–ª–∏—Ü—è –ë—Ä–∞–∑–∏–ª—ñ—ó?", ["–†—ñ–æ-–¥–µ-–ñ–∞–Ω–µ–π—Ä–æ", "–°–∞–Ω-–ü–∞—É–ª—É", "–ë—Ä–∞–∑–∏–ª—ñ–∞", "–ë—É–µ–Ω–æ—Å-–ê–π—Ä–µ—Å"], 2),
                ("–Ø–∫–∞ –∫—Ä–∞—ó–Ω–∞ –≤–∏–Ω–∞–π–ª–∞ —á–∞–π?", ["–Ü–Ω–¥—ñ—è", "–ö–∏—Ç–∞–π", "–Ø–ø–æ–Ω—ñ—è", "–ê–Ω–≥–ª—ñ—è"], 1),
                ("–Ø–∫–∞ –Ω–∞–π–±—ñ–ª—å—à–∞ —Ç–≤–∞—Ä–∏–Ω–∞?", ["–°–ª–æ–Ω", "–°–∏–Ω—ñ–π –∫–∏—Ç", "–ñ–∏—Ä–∞—Ñ", "–ë—ñ–ª–∏–π –≤–µ–¥–º—ñ–¥—å"], 1)
            ],
            "MMLU-Pro": [
                ("–£ –∫–≤–∞–Ω—Ç–æ–≤—ñ–π —Ç–µ–æ—Ä—ñ—ó –ø–æ–ª—è, —â–æ –ø–æ—è—Å–Ω—é—î –º–µ—Ö–∞–Ω—ñ–∑–º –•—ñ–≥–≥—Å–∞?", 
                 ["–ú–∞—Å—É –µ–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–∏—Ö —á–∞—Å—Ç–∏–Ω–æ–∫", "–ï–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π –∑–∞—Ä—è–¥", "–ö–≤–∞–Ω—Ç–æ–≤—É –∑–∞–ø–ª—É—Ç–∞–Ω—ñ—Å—Ç—å", "–ß–æ—Ä–Ω—ñ –¥—ñ—Ä–∏"], 0),
                ("–£ —Ç–µ–æ—Ä—ñ—ó –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–æ—ó —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ, —â–æ –ø–∏—Ç–∞—î –ø—Ä–æ–±–ª–µ–º–∞ P vs NP?",
                 ["–ß–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ª–µ–≥—à–∞ –∑–∞ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è", "–ß–∏ –∫–≤–∞–Ω—Ç–æ–≤—ñ –∫–æ–º–ø'—é—Ç–µ—Ä–∏ –º–æ–∂—É—Ç—å –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏ NP-–ø—Ä–æ–±–ª–µ–º–∏",
                  "–ß–∏ –≤—Å—ñ –ø—Ä–æ–±–ª–µ–º–∏ –º–æ–∂–Ω–∞ –≤–∏—Ä—ñ—à–∏—Ç–∏ –∑–∞ –ø–æ–ª—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —á–∞—Å", "–ß–∏ P –¥–æ—Ä—ñ–≤–Ω—é—î NP"], 3),
                ("–©–æ –≥–æ–≤–æ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–π –∑–∞–∫–æ–Ω —Ç–µ—Ä–º–æ–¥–∏–Ω–∞–º—ñ–∫–∏ –ø—Ä–æ –µ–Ω—Ç—Ä–æ–ø—ñ—é?",
                 ["–ï–Ω—Ç—Ä–æ–ø—ñ—è –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –ø–æ—Å—Ç—ñ–π–Ω–æ—é", "–ï–Ω—Ç—Ä–æ–ø—ñ—è –∑–º–µ–Ω—à—É—î—Ç—å—Å—è –∑ —á–∞—Å–æ–º", 
                  "–ï–Ω—Ç—Ä–æ–ø—ñ—è –∑—Ä–æ—Å—Ç–∞—î –≤ —ñ–∑–æ–ª—å–æ–≤–∞–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö", "–ï–Ω—Ç—Ä–æ–ø—ñ—è –Ω–µ –ø–æ–≤'—è–∑–∞–Ω–∞ –∑ –µ–Ω–µ—Ä–≥—ñ—î—é"], 2),
                ("–£ –º–æ–ª–µ–∫—É–ª—è—Ä–Ω—ñ–π –±—ñ–æ–ª–æ–≥—ñ—ó, —â–æ –æ–∑–Ω–∞—á–∞—î PCR?",
                 ["–ü–æ–ª—ñ–º–µ—Ä–∞–∑–Ω–∞ –ª–∞–Ω—Ü—é–≥–æ–≤–∞ —Ä–µ–∞–∫—Ü—ñ—è", "–†–µ–≥—ñ–æ–Ω –∫–æ–¥—É–≤–∞–Ω–Ω—è –±—ñ–ª–∫–∞", 
                  "–ü–µ—Ä–≤–∏–Ω–Ω–∞ –∫–ª—ñ—Ç–∏–Ω–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å", "–°–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—ó –±—ñ–ª–∫–∞"], 0),
                ("–Ø–∫–∞ —Ç–µ–æ—Ä–µ–º–∞ —Å—Ç–≤–µ—Ä–¥–∂—É—î, —â–æ –Ω–µ–º–∞—î —Ç—Ä—å–æ—Ö –¥–æ–¥–∞—Ç–Ω–∏—Ö —Ü—ñ–ª–∏—Ö —á–∏—Å–µ–ª a, b —ñ c, —â–æ –∑–∞–¥–æ–≤–æ–ª—å–Ω—è—é—Ç—å a‚Åø + b‚Åø = c‚Åø –¥–ª—è n > 2?",
                 ["–¢–µ–æ—Ä–µ–º–∞ –ü—ñ—Ñ–∞–≥–æ—Ä–∞", "–í–µ–ª–∏–∫–∞ —Ç–µ–æ—Ä–µ–º–∞ –§–µ—Ä–º–∞", 
                  "–¢–µ–æ—Ä–µ–º–∞ –ì–µ–¥–µ–ª—è –ø—Ä–æ –Ω–µ–ø–æ–≤–Ω–æ—Ç—É", "–§–æ—Ä–º—É–ª–∞ –ï–π–ª–µ—Ä–∞"], 1)
            ],
            "DROP": [
                ("–ù–∞ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü—ñ—ó –±—É–ª–æ 300 —É—á–∞—Å–Ω–∏–∫—ñ–≤ –∑ 40 –∫—Ä–∞—ó–Ω. –°–∫—ñ–ª—å–∫–∏ –∫—Ä–∞—ó–Ω –±—É–ª–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ?",
                 "40",
                 "40"),
                ("–£ –î–∂–æ–Ω–∞ 5 —è–±–ª—É–∫. –í—ñ–Ω –¥–∞—î 2 –ú–∞—Ä—ñ—ó —Ç–∞ 1 –ë–æ–±—É. –°–∫—ñ–ª—å–∫–∏ —è–±–ª—É–∫ —É –Ω—å–æ–≥–æ –∑–∞–ª–∏—à–∏–ª–æ—Å—è?",
                 "2",
                 "2"),
                ("–ü–æ—Ç—è–≥ –ø—Ä–æ—ó–∂–¥–∂–∞—î 120 –º–∏–ª—å –∑–∞ 2 –≥–æ–¥–∏–Ω–∏. –Ø–∫–∞ –π–æ–≥–æ —à–≤–∏–¥–∫—ñ—Å—Ç—å —É –º–∏–ª—è—Ö –Ω–∞ –≥–æ–¥–∏–Ω—É?",
                 "60",
                 "60"),
                ("–Ø–∫—â–æ –∫–Ω–∏–≥–∞ –º–∞—î 450 —Å—Ç–æ—Ä—ñ–Ω–æ–∫, —ñ –≤–∏ —á–∏—Ç–∞—î—Ç–µ 30 —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —â–æ–¥–Ω—è, —Å–∫—ñ–ª—å–∫–∏ –¥–Ω—ñ–≤ –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è, —â–æ–± —ó—ó –∑–∞–∫—ñ–Ω—á–∏—Ç–∏?",
                 "15",
                 "15"),
                ("–ü—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ –º–∞—î –¥–æ–≤–∂–∏–Ω—É 8 —ñ —à–∏—Ä–∏–Ω—É 5. –Ø–∫–∞ –π–æ–≥–æ –ø–ª–æ—â–∞?",
                 "40",
                 "40")
            ],
            "IF-Eval": [
                ("–í–∏–∫–æ–Ω–∞–π —Ü—ñ –∫—Ä–æ–∫–∏: 1) –ù–∞–ø–∏—à–∏ '–ø—Ä–∏–≤—ñ—Ç' 2) –ü–µ—Ä–µ–≤–µ—Ä–Ω–∏ 3) –í–µ–ª–∏–∫–∞ –ø–µ—Ä—à–∞ –ª—ñ—Ç–µ—Ä–∞",
                 "–¢—ñ–≤—ñ—Ä–ø",
                 "–¢—ñ–≤—ñ—Ä–ø"),
                ("–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó: 1) –í—ñ–∑—å–º–∏ –ø–µ—Ä—à—É –ª—ñ—Ç–µ—Ä—É '–∫—ñ—Ç' 2) –í—ñ–∑—å–º–∏ –æ—Å—Ç–∞–Ω–Ω—é –ª—ñ—Ç–µ—Ä—É '–ø–µ—Å' 3) –ü–æ—î–¥–Ω–∞–π —ó—Ö",
                 "–∫—Å",
                 "–∫—Å"),
                ("–ö—Ä–æ–∫–∏: 1) –ù–∞–ø–∏—à–∏ 'Python' 2) –í–∏–¥–∞–ª–∏ –ø–µ—Ä—à—É —Ç–∞ –æ—Å—Ç–∞–Ω–Ω—é –ª—ñ—Ç–µ—Ä–∏ 3) –ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ –Ω–∞ –≤–µ–ª–∏–∫—ñ –ª—ñ—Ç–µ—Ä–∏",
                 "YTHO",
                 "YTHO"),
                ("–ù–∞–ø—Ä—è–º–∫–∏: 1) –ù–∞–ø–∏—à–∏ '42' 2) –î–æ–¥–∞–π '17' 3) –ü–æ–º–Ω–æ–∂ –Ω–∞ 2",
                 "118",
                 "118"),
                ("–ü—Ä–æ—Ü–µ–¥—É—Ä–∞: 1) –ù–∞–ø–∏—à–∏ '–±–∞–Ω–∞–Ω' 2) –í–∏–¥–∞–ª–∏ –≤—Å—ñ '–∞' 3) –ü–µ—Ä–µ–≤–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
                 "–Ω–Ω–±",
                 "–Ω–Ω–±")
            ],
            "GPQA-Diamond": [
                ("–ü–æ—è—Å–Ω–∏ –≥—ñ–ø–æ—Ç–µ–∑—É –†—ñ–º–∞–Ω–∞ –ø—Ä–æ—Å—Ç–æ—é –º–æ–≤–æ—é",
                 "–¶–µ –ø—Ä–æ —Ä–æ–∑–ø–æ–¥—ñ–ª –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–µ–ª",
                 "–ø—Ä–æ—Å—Ç—ñ —á–∏—Å–ª–∞"),
                ("–Ø–∫—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏, —è–∫—â–æ P=NP –±—É–¥–µ –¥–æ–≤–µ–¥–µ–Ω–æ?",
                 "–ë–∞–≥–∞—Ç–æ —Å–∫–ª–∞–¥–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å—Ç–∞–Ω—É—Ç—å –ª–µ–≥–∫–∏–º–∏ –¥–ª—è –≤–∏—Ä—ñ—à–µ–Ω–Ω—è",
                 "P=NP"),
                ("–û–ø–∏—à–∏ –∫–≤–∞–Ω—Ç–æ–≤—É –∑–∞–ø–ª—É—Ç–∞–Ω—ñ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ—é –º–æ–≤–æ—é",
                 "–ö–æ–ª–∏ —á–∞—Å—Ç–∏–Ω–∫–∏ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –∑–≤'—è–∑–∞–Ω–∏–º–∏ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—ñ",
                 "–∫–≤–∞–Ω—Ç–æ–≤–∞ –∑–∞–ø–ª—É—Ç–∞–Ω—ñ—Å—Ç—å"),
                ("–Ø–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É –ú—ñ–ª–ª–µ—Ä–∞-–Æ—Ä—ñ?",
                 "–ü–æ–∫–∞–∑–∞–≤, —è–∫ –º–æ–≥–ª–æ –≤–∏–Ω–∏–∫–Ω—É—Ç–∏ –∂–∏—Ç—Ç—è –∑ –ø—Ä–æ—Å—Ç–∏—Ö —Ö—ñ–º—ñ—á–Ω–∏—Ö —Ä–µ—á–æ–≤–∏–Ω",
                 "–ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –∂–∏—Ç—Ç—è"),
                ("–ü–æ—è—Å–Ω–∏ –ø–æ–Ω—è—Ç—Ç—è –µ–Ω—Ç—Ä–æ–ø—ñ—ó –¥–ª—è 5-—Ä—ñ—á–Ω–æ—ó –¥–∏—Ç–∏–Ω–∏",
                 "–¶–µ –º—ñ—Ä–∞ –±–µ–∑–ø–æ—Ä—è–¥–∫—É –≤ —Å–∏—Å—Ç–µ–º—ñ",
                 "–±–µ–∑–ø–æ—Ä—è–¥–æ–∫")
            ],
            "FRAMES": [
                ("–î—ñ–∞–ª–æ–≥: A: '–ú–µ–Ω—ñ —Å–ø–æ–¥–æ–±–∞–≤—Å—è —Ü–µ–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω!' B: '–ú–µ–Ω—ñ —Ç–µ–∂, –ø–∞—Å—Ç–∞ –±—É–ª–∞ —á—É–¥–æ–≤–∞'. –í–∏–∑–Ω–∞—á –Ω–∞—Å—Ç—Ä–æ—ó",
                 "–ø–æ–∑–∏—Ç–∏–≤–Ω–∏–π",
                 "–ø–æ–∑–∏—Ç–∏–≤–Ω–∏–π"),
                ("–†–æ–∑–º–æ–≤–∞: A: '–¶–µ–π –ø—Ä–æ–¥—É–∫—Ç –∂–∞—Ö–ª–∏–≤–∏–π' B: '–ü–æ–≥–æ–¥–∂—É—é—Å—å, –Ω–∞–π–≥—ñ—Ä—à–∞ –ø–æ–∫—É–ø–∫–∞'. –ù–∞—Å—Ç—Ä–æ—ó?",
                 "–Ω–µ–≥–∞—Ç–∏–≤–Ω–∏–π",
                 "–Ω–µ–≥–∞—Ç–∏–≤–Ω–∏–π"),
                ("–û–±–º—ñ–Ω: A: '–§—ñ–ª—å–º –±—É–≤ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π' B: '–Ø –æ—á—ñ–∫—É–≤–∞–≤ –±—ñ–ª—å—à–æ–≥–æ'. –ù–∞—Å—Ç—Ä–æ—ó?",
                 "–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∏–π",
                 "–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∏–π"),
                ("–ß–∞—Ç: A: '–ù–∞–π–∫—Ä–∞—â–∏–π –¥–µ–Ω—å —É –∂–∏—Ç—Ç—ñ!' B: '–†–∞–¥–∏–π –∑–∞ —Ç–µ–±–µ!'. –ï–º–æ—Ü—ñ—ó?",
                 "—â–∞—Å–ª–∏–≤–∏–π",
                 "—â–∞—Å–ª–∏–≤–∏–π"),
                ("–û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è: A: '–Ø —Ç–∞–∫ —Ä–æ–∑—á–∞—Ä–æ–≤–∞–Ω–∏–π' B: '–í—Å–µ –±—É–¥–µ –¥–æ–±—Ä–µ'. –ù–∞—Å—Ç—Ä—ñ–π?",
                 "—Ä–æ–∑—á–∞—Ä–æ–≤–∞–Ω–∏–π",
                 "—Ä–æ–∑—á–∞—Ä–æ–≤–∞–Ω–∏–π")
            ],
            "LongBench": [
                ("–†–µ–∑—é–º—É–π —Ç–µ–∫—Å—Ç: " + ("–®—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç –∑–º—ñ–Ω—é—î –≥–∞–ª—É–∑—ñ. " * 10),
                 "–®–Ü –∑–º—ñ–Ω—é—î –≥–∞–ª—É–∑—ñ",
                 "–®–Ü –∑–º—ñ–Ω—é—î"),
                (("–Ü—Å—Ç–æ—Ä—ñ—è –†–∏–º—É —Ç—Ä–∏–≤–∞—î –ø–æ–Ω–∞–¥ 2800 —Ä–æ–∫—ñ–≤. " * 10) + "–°–∫—ñ–ª—å–∫–∏ —Ä–æ–∫—ñ–≤ —ñ—Å–Ω—É—î –†–∏–º?",
                 "2800 —Ä–æ–∫—ñ–≤",
                 "2800"),
                ("–ü–æ–≤—Ç–æ—Ä–∏ —Ü–µ —á–∏—Å–ª–æ: " + "12345 " * 15,
                 "12345",
                 "12345"),
                (("–ú–∞—à–∏–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è –≤–∏–º–∞–≥–∞—î –≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö. " * 12) + "–©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è ML?",
                 "–≤–µ–ª–∏–∫—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö",
                 "–≤–µ–ª–∏–∫—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö"),
                (("–ó–º—ñ–Ω–∞ –∫–ª—ñ–º–∞—Ç—É –≤–ø–ª–∏–≤–∞—î –Ω–∞ –µ–∫–æ—Å–∏—Å—Ç–µ–º–∏ –≤ —É—Å—å–æ–º—É —Å–≤—ñ—Ç—ñ. " * 10) + "–©–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ –µ–∫–æ—Å–∏—Å—Ç–µ–º–∏?",
                 "–∑–º—ñ–Ω–∞ –∫–ª—ñ–º–∞—Ç—É",
                 "–∑–º—ñ–Ω–∞ –∫–ª—ñ–º–∞—Ç—É")
            ],
            "HumanEval-Mul": [
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –æ–±–µ—Ä—Ç–∞–Ω–Ω—è —Ä—è–¥–∫–∞", 
                 "def reverse_string(s):\n    return s[::-1]",
                 "assert reverse_string('–ø—Ä–∏–≤—ñ—Ç') == '—Ç—ñ–≤–∏—Ä–ø'"),
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ñ–∞–∫—Ç–æ—Ä—ñ–∞–ª—É",
                 "def factorial(n):\n    return 1 if n == 0 else n * factorial(n-1)",
                 "assert factorial(5) == 120"),
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —á–∏ —á–∏—Å–ª–æ –ø—Ä–æ—Å—Ç–µ",
                 "def is_prime(n):\n    if n <= 1:\n        return False\n    for i in range(2, int(n**0.5)+1):\n        if n % i == 0:\n            return False\n    return True",
                 "assert is_prime(11) == True"),
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –º–∞–∫—Å–∏–º—É–º—É –≤ —Å–ø–∏—Å–∫—É",
                 "def find_max(lst):\n    return max(lst)",
                 "assert find_max([1,5,3]) == 5"),
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –≥–æ–ª–æ—Å–Ω–∏—Ö —É —Ä—è–¥–∫—É",
                 "def count_vowels(s):\n    return sum(1 for c in s.lower() if c in '–∞–µ–∏—ñ–æ—É—è—é—î—ó')",
                 "assert count_vowels('–ø—Ä–∏–≤—ñ—Ç') == 2")
            ],
            "LiveCodeBench": [
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –Ω–∞–π–¥–æ–≤—à–æ–≥–æ –ø—ñ–¥—Ä—è–¥–∫–∞ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω—å",
                 "def longest_substring(s):\n    used = {}\n    max_length = start = 0\n    for i, c in enumerate(s):\n        if c in used and start <= used[c]:\n            start = used[c] + 1\n        else:\n            max_length = max(max_length, i - start + 1)\n        used[c] = i\n    return max_length",
                 "assert longest_substring('abcabcbb') == 3"),
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å—É –¥—É–∂–æ–∫",
                 "def is_balanced(s):\n    stack = []\n    pairs = {'(': ')', '[': ']', '{': '}'}\n    for char in s:\n        if char in pairs:\n            stack.append(char)\n        elif stack and char == pairs[stack[-1]]:\n            stack.pop()\n        else:\n            return False\n    return len(stack) == 0",
                 "assert is_balanced('({[]})') == True"),
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –æ–±'—î–¥–Ω–∞–Ω–Ω—è –¥–≤–æ—Ö –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–∏—Ö —Å–ø–∏—Å–∫—ñ–≤",
                 "def merge_sorted(a, b):\n    return sorted(a + b)",
                 "assert merge_sorted([1,3], [2,4]) == [1,2,3,4]"),
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –∑—ñ —Å–ø–∏—Å–∫—É",
                 "def remove_duplicates(lst):\n    return list(dict.fromkeys(lst))",
                 "assert remove_duplicates([1,2,2,3]) == [1,2,3]"),
                ("–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –§—ñ–±–æ–Ω–∞—á—á—ñ –¥–æ n —á–ª–µ–Ω—ñ–≤",
                 "def fibonacci(n):\n    a, b = 0, 1\n    for _ in range(n):\n        yield a\n        a, b = b, a + b",
                 "assert list(fibonacci(5)) == [0,1,1,2,3]")
            ],
            "LiveCodeBench-COT": [
                ("–ü–æ—è—Å–Ω–∏, –∞ –ø–æ—Ç—ñ–º –Ω–∞–ø–∏—à–∏ –∫–æ–¥ –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –Ω–∞–π–¥–æ–≤—à–æ–≥–æ –ø—ñ–¥—Ä—è–¥–∫–∞ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω—å",
                 "–°–ø–æ—á–∞—Ç–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –º–µ—Ç–æ–¥ –∫–æ–≤–∑–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –∑ –¥–≤–æ–º–∞ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞–º–∏...",
                 "def length_of_longest_substring(s):"),
                ("–û–ø–∏—à–∏, –∞ –ø–æ—Ç—ñ–º —Ä–µ–∞–ª—ñ–∑—É–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–∏—Ö —Å—Ç–µ–∫",
                 "–°—Ç–µ–∫ - —Ü–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ LIFO –∑ –æ–ø–µ—Ä–∞—Ü—ñ—è–º–∏ push/pop...",
                 "class Stack:"),
                ("–ü–æ—è—Å–Ω–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ –ø–æ—à—É–∫—É, –∞ –ø–æ—Ç—ñ–º —Ä–µ–∞–ª—ñ–∑—É–π –π–æ–≥–æ",
                 "–ë—ñ–Ω–∞—Ä–Ω–∏–π –ø–æ—à—É–∫ –ø—Ä–∞—Ü—é—î —à–ª—è—Ö–æ–º –ø–æ–¥—ñ–ª—É —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É...",
                 "def binary_search(arr, target):"),
                ("–û–ø–∏—à–∏ —à–≤–∏–¥–∫–µ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è, –∞ –ø–æ—Ç—ñ–º –Ω–∞–ø–∏—à–∏ –∫–æ–¥",
                 "–®–≤–∏–¥–∫–µ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é '—Ä–æ–∑–¥—ñ–ª—è–π —ñ –≤–æ–ª–æ–¥–∞—Ä—é–π'...",
                 "def quicksort(arr):"),
                ("–ü–æ—è—Å–Ω–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –î–µ–π–∫—Å—Ç—Ä–∏, –∞ –ø–æ—Ç—ñ–º —Ä–µ–∞–ª—ñ–∑—É–π –π–æ–≥–æ",
                 "–ê–ª–≥–æ—Ä–∏—Ç–º –î–µ–π–∫—Å—Ç—Ä–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–∞–π–∫–æ—Ä–æ—Ç—à—ñ —à–ª—è—Ö–∏...",
                 "def dijkstra(graph, start):")
            ],
            "Codeforces": [
                ("1A: –¢–µ–∞—Ç—Ä–∞–ª—å–Ω–∞ –ø–ª–æ—â–∞ - –≤–∏–∫–ª–∞—Å—Ç–∏ –ø—Ä—è–º–æ–∫—É—Ç–Ω—É –æ–±–ª–∞—Å—Ç—å –∫–≤–∞–¥—Ä–∞—Ç–Ω–∏–º–∏ –ø–ª–∏—Ç–∫–∞–º–∏", "–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –∂–∞–¥—ñ–±–Ω—ñ—Å—Ç—å", "–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞"),
                ("4A: –ö–∞–≤—É–Ω - –ø–æ–¥—ñ–ª–∏—Ç–∏ –∫–∞–≤—É–Ω –Ω–∞ –ø–∞—Ä–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏", "–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –ø–µ—Ä–µ–±—ñ—Ä", "–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞"),
                ("71A: –ó–∞–Ω–∞–¥—Ç–æ –¥–æ–≤–≥—ñ —Å–ª–æ–≤–∞ - —Å–∫–æ—Ä–æ—Ç–∏—Ç–∏ –¥–æ–≤–≥—ñ —Å–ª–æ–≤–∞", "—Ä—è–¥–∫–∏", "—Ä—è–¥–∫–∏"),
                ("158A: –ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä–∞—É–Ω–¥ - –ø—Ä–æ–π—Ç–∏ —É—á–∞—Å–Ω–∏–∫—ñ–≤ —É –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä–∞—É–Ω–¥", "—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è", "—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è"),
                ("50A: –£–∫–ª–∞–¥–∞–Ω–Ω—è –¥–æ–º—ñ–Ω–æ - –º–∞–∫—Å–∏–º—ñ–∑—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ–º—ñ–Ω–æ –Ω–∞ –¥–æ—à—Ü—ñ", "–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –∂–∞–¥—ñ–±–Ω—ñ—Å—Ç—å", "–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞")
            ],
            "SWE-Verified": [
                ("–í–∏–ø—Ä–∞–≤ –ø–æ–º–∏–ª–∫—É –Ω—É–ª—å–æ–≤–æ–≥–æ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞: String s; s.length();", 
                 "–î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É: if (s != null)", 
                 "null check"),
                ("–í–∏–ø—Ä–∞–≤ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–∏–π —Ü–∏–∫–ª: while(i < 10) { j++; }",
                 "–î–æ–¥–∞—Ç–∏ i++ –≤ —Ü–∏–∫–ª—ñ",
                 "—ñ–Ω–∫—Ä–µ–º–µ–Ω—Ç –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞"),
                ("–í–∏–ø—Ä–∞–≤ –≤–∏—Ç—ñ–∫ –ø–∞–º'—è—Ç—ñ —É –∫–æ–¥—ñ –Ω–∞ C++ –∑ new[]",
                 "–î–æ–¥–∞—Ç–∏ –≤–∏–∫–ª–∏–∫ delete[]",
                 "—É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–∞–º'—è—Ç—Ç—é"),
                ("–í–∏–ø—Ä–∞–≤ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å SQL-—ñ–Ω'—î–∫—Ü—ñ—ó",
                 "–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ñ –∑–∞–ø–∏—Ç–∏",
                 "–±–µ–∑–ø–µ–∫–∞ SQL"),
                ("–í–∏–ø—Ä–∞–≤ —Å—Ç–∞–Ω –≥–æ–Ω–∫–∏ —É –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤–æ–º—É –∫–æ–¥—ñ",
                 "–î–æ–¥–∞—Ç–∏ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –º'—é—Ç–µ–∫—Å—ñ–≤",
                 "–±–µ–∑–ø–µ–∫–∞ –ø–æ—Ç–æ–∫—ñ–≤")
            ],
            "Aider-Edit": [
                ("–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏ —Ü–µ–π –∫–æ–¥ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Å–ø–∏—Å–∫–æ–≤–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è:\nnumbers = []\nfor i in range(10):\n    numbers.append(i*2)",
                 "numbers = [i*2 for i in range(10)]",
                 "—Å–ø–∏—Å–∫–æ–≤–µ –≤–∫–ª—é—á–µ–Ω–Ω—è"),
                ("–ó—Ä–æ–±–∏ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é –æ–±—Ä–æ–±–∫–∏ None: def foo(x): return x+1",
                 "def foo(x): return None if x is None else x+1",
                 "–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ None"),
                ("–û–ø—Ç–∏–º—ñ–∑—É–π —Ü–µ–π –≤–∫–ª–∞–¥–µ–Ω–∏–π —Ü–∏–∫–ª O(n¬≤) –¥–æ O(n)",
                 "–í–∏–∫–æ—Ä–∏—Å—Ç–∞–π —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—é –¥–ª—è O(1) –ø–æ—à—É–∫—É",
                 "–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è"),
                ("–î–æ–¥–∞–π –ø—ñ–¥–∫–∞–∑–∫–∏ —Ç–∏–ø—ñ–≤ –¥–æ —Ü—ñ—î—ó —Ñ—É–Ω–∫—Ü—ñ—ó Python",
                 "def func(x: int) -> str:",
                 "–ø—ñ–¥–∫–∞–∑–∫–∏ —Ç–∏–ø—ñ–≤"),
                ("–ó—Ä–æ–±–∏ —Ü–µ–π –∫–æ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º –¥–æ PEP 8",
                 "–í–∏–ø—Ä–∞–≤–∏ –≤—ñ–¥—Å—Ç—É–ø–∏ —Ç–∞ —ñ–º–µ–Ω–∞ –∑–º—ñ–Ω–Ω–∏—Ö",
                 "—Å—Ç–∏–ª—å –∫–æ–¥—É")
            ],
            "Aider-Polyglot": [
                ("–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ —Ü–µ–π Python –Ω–∞ JavaScript: def add(a,b): return a+b",
                 "function add(a,b) { return a+b }",
                 "function add"),
                ("–ü–µ—Ä–µ–∫–ª–∞–¥–∏ —Ü–µ–π Java –Ω–∞ Python: public class Hello { public static void main() { System.out.println('Hello'); } }",
                 "def main():\n    print('Hello')",
                 "—Ñ—É–Ω–∫—Ü—ñ—è print"),
                ("–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ —Ü–µ–π C++ –≤–µ–∫—Ç–æ—Ä –Ω–∞ Python: vector<int> v = {1,2,3};",
                 "v = [1, 2, 3]",
                 "—Å–ø–∏—Å–æ–∫"),
                ("–ü–µ—Ä–µ–∫–ª–∞–¥–∏ —Ü–µ–π SQL –∑–∞–ø–∏—Ç –Ω–∞ Pandas: SELECT name FROM users WHERE age > 30",
                 "users[users.age > 30]['name']",
                 "–∑–∞–ø–∏—Ç DataFrame"),
                ("–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ —Ü–µ–π Bash –Ω–∞ Python: for file in *.txt; do echo $file; done",
                 "import glob\nfor file in glob.glob('*.txt'):\n    print(file)",
                 "–º–æ–¥—É–ª—å glob")
            ],
            "MATH-500": [
                ("–†–æ–∑–≤'—è–∂–∏: x¬≤ - 5x + 6 = 0", "x = 2 –∞–±–æ x = 3", "2,3"),
                ("–û–±—á–∏—Å–ª–∏ –ø–ª–æ—â—É –∫–æ–ª–∞ –∑ —Ä–∞–¥—ñ—É—Å–æ–º 5", "78.5398", "78.5398"),
                ("–ó–Ω–∞–π–¥–∏ –ø–æ—Ö—ñ–¥–Ω—É x¬≥ + 2x¬≤ - x", "3x¬≤ + 4x - 1", "3x¬≤+4x-1"),
                ("–†–æ–∑–≤'—è–∂–∏: 2x + 3 = 15", "x = 6", "6"),
                ("–û–±—á–∏—Å–ª–∏ 5! (—Ñ–∞–∫—Ç–æ—Ä—ñ–∞–ª)", "120", "120")
            ],
            "AIME": [
                ("–ó–Ω–∞–π–¥–∏ –∑–∞–ª–∏—à–æ–∫ –≤—ñ–¥ –¥—ñ–ª–µ–Ω–Ω—è 7^2023 –Ω–∞ 5", "3", "3"),
                ("–û–±—á–∏—Å–ª–∏ —Å—É–º—É –ø–µ—Ä—à–∏—Ö 100 –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–µ–ª", "24133", "24133"),
                ("–ó–Ω–∞–π–¥–∏ –Ω–∞–π–º–µ–Ω—à–µ –¥–æ–¥–∞—Ç–Ω–µ —Ü—ñ–ª–µ x —Ç–∞–∫–µ, —â–æ 2x ‚â° 1 mod 11", "6", "6"),
                ("–û–±—á–∏—Å–ª–∏ —ñ–Ω—Ç–µ–≥—Ä–∞–ª e^x –≤—ñ–¥ 0 –¥–æ 1", "e - 1", "e-1"),
                ("–ó–Ω–∞–π–¥–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ–¥–∞—Ç–Ω–∏—Ö –¥—ñ–ª—å–Ω–∏–∫—ñ–≤ 360", "24", "24")
            ],
            "CNMO": [
                ("–†–æ–∑–≤'—è–∂–∏: x¬≥ - 6x¬≤ + 11x - 6 = 0", "x = 1, 2, 3", "1,2,3"),
                ("–ó–Ω–∞–π–¥–∏ –ø–ª–æ—â—É —Ç—Ä–∏–∫—É—Ç–Ω–∏–∫–∞ –∑—ñ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏ 7, 24, 25", "84", "84"),
                ("–û–±—á–∏—Å–ª–∏ —Å—É–º—É 1 + 1/2 + 1/4 + 1/8 + ...", "2", "2"),
                ("–ó–Ω–∞–π–¥–∏ –ù–°–î —á–∏—Å–µ–ª 1071 —ñ 462", "21", "21"),
                ("–†–æ–∑–≤'—è–∂–∏ –¥–ª—è x: log‚ÇÇ(x) = 5", "32", "32")
            ],
            "CLUEWSC": [
                ("–ü–µ—Ä–µ–∫–ª–∞–¥–∏ –Ω–∞ –∞–Ω–≥–ª—ñ–π—Å—å–∫—É: ‰ªäÂ§©Â§©Ê∞îÊÄé‰πàÊ†∑?", "How's the weather today?", "weather"),
                ("–ü–µ—Ä–µ–∫–ª–∞–¥–∏: ‰∫∫Â∑•Êô∫ËÉΩÊòØ‰ªÄ‰πàÊÑèÊÄù?", "What does artificial intelligence mean?", "AI"),
                ("–ü–µ—Ä–µ–∫–ª–∞–¥–∏: ËØ∑ÊâìÂºÄÁ™óÊà∑", "Please open the window", "open window"),
                ("–ü–µ—Ä–µ–∫–ª–∞–¥–∏: ÊàëÈ•ø‰∫Ü", "I'm hungry", "hungry"),
                ("–ü–µ—Ä–µ–∫–ª–∞–¥–∏: Ëøô‰∏™Â§öÂ∞ëÈí±?", "How much does this cost?", "price")
            ],
            "C-Eval": [
                ("‰ªÄ‰πàÊòØ‰∫∫Â∑•Êô∫ËÉΩ?", "–®—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç - —Ü–µ –∫–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ —Å–∏—Å—Ç–µ–º–∏, —â–æ —ñ–º—ñ—Ç—É—é—Ç—å –ª—é–¥—Å—å–∫–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç", "–®–Ü"),
                ("‰∏≠ÂõΩÁöÑÈ¶ñÈÉΩÊòØÂì™Èáå?", "–ü–µ–∫—ñ–Ω", "–ü–µ–∫—ñ–Ω"),
                ("1+1Á≠â‰∫éÂá†?", "2", "2"),
                ("Ê∞¥ÁöÑÂåñÂ≠¶ÂºèÊòØ‰ªÄ‰πà?", "H‚ÇÇO", "H2O"),
                ("PythonÊòØ‰ªÄ‰πà?", "–ú–æ–≤–∞ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è", "–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è")
            ],
            "C-SimpleQA": [
                ("Ë∞ÅÂèëÊòé‰∫ÜÁîµËØù?", "–û–ª–µ–∫—Å–∞–Ω–¥—Ä –ì—Ä–µ—Ö–µ–º –ë–µ–ª–ª", "–ë–µ–ª–ª"),
                ("Âú∞ÁêÉÊòØÂπ≥ÁöÑËøòÊòØÂúÜÁöÑ?", "–ö—Ä—É–≥–ª–∞", "–∫—Ä—É–≥–ª–∞"),
                ("Â§™Èò≥Á≥ªÊúâÂ§öÂ∞ëÈ¢óË°åÊòü?", "8", "8"),
                ("‰∏≠ÂõΩÁöÑÈù¢ÁßØÊòØÂ§öÂ∞ë?", "–ü—Ä–∏–±–ª–∏–∑–Ω–æ 9.6 –º–ª–Ω –∫–º¬≤", "9.6 –º–ª–Ω"),
                ("Ë∞ÅÂÜô‰∫Ü„ÄäÁ∫¢Ê•ºÊ¢¶„Äã?", "–¶–∞–æ –°—é–µ—Ü—ñ–Ω—å", "–¶–∞–æ")
            ]
        }
        return test_data

    def _query_gpt4o(self, prompt: str, max_tokens: int = 500) -> str:
        """–ó–∞–ø–∏—Ç –¥–æ GPT-4 —á–µ—Ä–µ–∑ OpenRouter"""
        try:
            completion = self.client.chat.completions.create(
                model="openai/gpt-4",
                messages=[{"role": "user", "content": prompt}],
                max_tokens=max_tokens,
                temperature=0.7,
                timeout=30
            )
            return completion.choices[0].message.content
        except Exception as e:
            print(f"üî¥ –ü–æ–º–∏–ª–∫–∞ API: {str(e)}")
            return None

    def _check_answer(self, metric: str, test_case, response: str) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ"""
        if not response or not response.strip():
            return False
            
        response = response.lower().strip()
        
        # –°–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –¥–ª—è —Ç–µ—Å—Ç—ñ–≤ –∑ –ª–∞–Ω—Ü—é–∂–∫–æ–º –º—ñ—Ä–∫—É–≤–∞–Ω—å
        if "COT" in metric:
            explanation_keyword = test_case[1].lower().split()[0]
            code_keyword = test_case[2].lower().split('(')[0]
            
            has_explanation = explanation_keyword in response
            has_code = code_keyword in response
            
            return has_explanation and has_code
        
        # –î–ª—è —Ç–µ—Å—Ç—ñ–≤ –∑ –≤–∞—Ä—ñ–∞–Ω—Ç–∞–º–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
        if "MMLU" in metric:
            correct_index = test_case[2]
            correct_answer = test_case[1][correct_index].lower()
            return correct_answer in response
        
        # –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–æ–¥—É
        if "HumanEval" in metric or "LiveCodeBench" in metric:
            expected_keywords = test_case[2].lower().split('assert ')[1].split('(')[0]
            return expected_keywords in response
        
        # –î–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏—Ö –∑–∞–¥–∞—á
        if "MATH" in metric or "AIME" in metric or "CNMO" in metric:
            correct_answer = str(test_case[1]).lower()
            return correct_answer in response
        
        # –î–ª—è –∫–∏—Ç–∞–π—Å—å–∫–∏—Ö —Ç–µ—Å—Ç—ñ–≤
        if metric in ["CLUEWSC", "C-Eval", "C-SimpleQA"]:
            correct_keyword = str(test_case[2]).lower()
            return correct_keyword in response
        
        # –î–ª—è —ñ–Ω—à–∏—Ö —Ç–µ—Å—Ç—ñ–≤
        if metric in ["DROP", "IF-Eval", "GPQA-Diamond", "FRAMES", "LongBench"]:
            correct_answer = str(test_case[1]).lower()
            return correct_answer in response
        
        return False

    def _evaluate_metric(self, metric: str, num_samples: int):
        """–û—Ü—ñ–Ω–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –º–µ—Ç—Ä–∏–∫–∏"""
        if metric not in self.test_data or not self.test_data[metric]:
            print(f"‚ö†Ô∏è –ù–µ–º–∞—î —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –¥–ª—è {metric}")
            return
            
        samples = self.test_data[metric][:num_samples]
        correct = 0
        detailed_results = []
        
        print(f"\nüîé –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è {metric} ({len(samples)} –ø—Ä–∏–∫–ª–∞–¥—ñ–≤)...")
        
        for i, test_case in enumerate(samples):
            try:
                question = test_case[0]
                print(f"\nüìå –ü—Ä–∏–∫–ª–∞–¥ {i+1}: {question[:60]}...")
                
                start_time = time.time()
                response = self._query_gpt4o(question, 
                                          max_tokens=1024 if metric in ["LongBench", "LiveCodeBench-COT"] else 500)
                elapsed = time.time() - start_time
                
                if response is None:
                    raise Exception("–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø–∏—Ç—É –¥–æ API")
                
                is_correct = self._check_answer(metric, test_case, response)
                correct += 1 if is_correct else 0
                
                detailed_results.append({
                    "–ø–∏—Ç–∞–Ω–Ω—è": question,
                    "–≤—ñ–¥–ø–æ–≤—ñ–¥—å": response,
                    "–ø—Ä–∞–≤–∏–ª—å–Ω–æ": is_correct,
                    "—á–∞—Å": elapsed
                })
                
                print(f"   {'‚úÖ' if is_correct else '‚ùå'} –ß–∞—Å: {elapsed:.2f}—Å")
                print(f"   –í—ñ–¥–ø–æ–≤—ñ–¥—å: {response[:100]}..." if response else "   –ù–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ")
                
            except Exception as e:
                print(f"   ‚ùó –ü–æ–º–∏–ª–∫–∞: {str(e)}")
                detailed_results.append({
                    "–ø–∏—Ç–∞–Ω–Ω—è": question,
                    "–≤—ñ–¥–ø–æ–≤—ñ–¥—å": f"–ü–æ–º–∏–ª–∫–∞: {str(e)}",
                    "–ø—Ä–∞–≤–∏–ª—å–Ω–æ": False,
                    "—á–∞—Å": 0
                })
        
        accuracy = correct / len(samples) if samples else 0
        avg_time = sum(r['—á–∞—Å'] for r in detailed_results) / len(samples) if samples else 0
        
        self.results[metric] = {
            "—Ç–æ—á–Ω—ñ—Å—Ç—å": accuracy,
            "—Å–µ—Ä–µ–¥–Ω—ñ–π_—á–∞—Å": avg_time,
            "—Ç–µ—Å—Ç–æ–≤–∞–Ω—ñ_–ø—Ä–∏–∫–ª–∞–¥–∏": len(samples),
            "–¥–µ—Ç–∞–ª—å–Ω—ñ_—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏": detailed_results
        }

    def run_benchmark(self, num_samples: int = 5) -> Dict[str, Dict]:
        """–ó–∞–ø—É—Å–∫ –ø–æ–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è"""
        print("üöÄ –ü–æ—á–∞—Ç–æ–∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è GPT-4\n")
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ API
        test_response = self._query_gpt4o("–°–∫–∞–∂–∏ '—Ç–µ—Å—Ç'", max_tokens=10)
        if not test_response:
            print("üî¥ –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ API, –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")
            return {}
        
        print("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ API —É—Å–ø—ñ—à–Ω–µ")
        
        for category, subcategories in self.metrics.items():
            print(f"\nüîπ {category.upper()}")
            
            if isinstance(subcategories, dict):
                for subcategory, metrics in subcategories.items():
                    print(f"  ‚öôÔ∏è {subcategory}")
                    for metric in metrics:
                        self._evaluate_metric(metric, num_samples)
            else:
                for metric in subcategories:
                    self._evaluate_metric(metric, num_samples)
        
        print("\n‚úÖ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
        return self.results

    def generate_report(self) -> pd.DataFrame:
        """–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑–≤—ñ—Ç—É"""
        report_data = []
        for metric, result in self.results.items():
            report_data.append({
                "–ú–µ—Ç—Ä–∏–∫–∞": metric,
                "–¢–æ—á–Ω—ñ—Å—Ç—å (%)": f"{result['—Ç–æ—á–Ω—ñ—Å—Ç—å']*100:.1f}",
                "–°–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å (—Å)": f"{result['—Å–µ—Ä–µ–¥–Ω—ñ–π_—á–∞—Å']:.2f}",
                "–ü—Ä–∏–∫–ª–∞–¥–∏": result['—Ç–µ—Å—Ç–æ–≤–∞–Ω—ñ_–ø—Ä–∏–∫–ª–∞–¥–∏'],
                "–°—Ç–∞—Ç—É—Å": "‚úÖ –£—Å–ø—ñ—Ö" if result['—Ç–æ—á–Ω—ñ—Å—Ç—å'] >= 0.7 else "‚ö†Ô∏è –ß–∞—Å—Ç–∫–æ–≤–æ" if result['—Ç–æ—á–Ω—ñ—Å—Ç—å'] >= 0.4 else "‚ùå –ù–µ–≤–¥–∞—á–∞",
                "–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ": result['–¥–µ—Ç–∞–ª—å–Ω—ñ_—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏'][0]['–≤—ñ–¥–ø–æ–≤—ñ–¥—å'][:50] + "..." if result['–¥–µ—Ç–∞–ª—å–Ω—ñ_—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏'] else ""
            })
        return pd.DataFrame(report_data)

    def save_results(self):
        """–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —É —Ñ–∞–π–ª–∏"""
        timestamp = time.strftime("%Y%m%d-%H%M%S")
        
        report = self.generate_report()
        csv_file = f"gpt4_benchmark_{timestamp}.csv"
        report.to_csv(csv_file, index=False)
        
        json_file = f"gpt4_benchmark_details_{timestamp}.json"
        with open(json_file, 'w', encoding='utf-8') as f:
            json.dump(self.results, f, ensure_ascii=False, indent=2)
        
        print(f"\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–æ:")
        print(f"- –ó–≤–µ–¥–µ–Ω–∏–π –∑–≤—ñ—Ç: {csv_file}")
        print(f"- –î–µ—Ç–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ: {json_file}")

def check_dependencies():
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π"""
    required = {'requests', 'pandas', 'openai'}
    try:
        installed = {pkg.key for pkg in pkg_resources.working_set}
        missing = required - installed
        if missing:
            print(f"üîß –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö –ø–∞–∫–µ—Ç—ñ–≤: {', '.join(missing)}")
            subprocess.check_call([sys.executable, '-m', 'pip', 'install', *missing])
    except:
        try:
            import requests
            import pandas
            import openai
        except ImportError as e:
            print(f"üî¥ –í—ñ–¥—Å—É—Ç–Ω—è –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å: {str(e)}")
            print("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞–∫–µ—Ç–∏ –≤—Ä—É—á–Ω—É:")
            print("pip install requests pandas openai")
            sys.exit(1)

if __name__ == "__main__":
    check_dependencies()
    
    try:
        print("üîç –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è GPT-4...")
        benchmark = GPT4oBenchmark()
        benchmark.run_benchmark(num_samples=5)
        
        print("\nüìã –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:")
        report = benchmark.generate_report()
        print(report.to_markdown(tablefmt="grid", stralign="left"))
        
        benchmark.save_results()
        
    except Exception as e:
        print(f"üî¥ –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞: {str(e)}")